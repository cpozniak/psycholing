<!DOCTYPE html>
<html>
<head>
  <script src="jatos.js"></script>
 <script src="https://unpkg.com/jspsych@7.3.4"></script>
 <script src="https://unpkg.com/@jspsych/plugin-html-keyboard-response@1.1.3"></script>
 <script src="https://unpkg.com/@jspsych/plugin-html-button-response@1.1.3"></script>
 <link href="https://unpkg.com/jspsych@7.3.4/css/jspsych.css" rel="stylesheet" type="text/css" />
 <script src="https://unpkg.com/@jspsych/plugin-survey-multi-choice@1.1.3"></script>
 <script src="https://unpkg.com/@jspsych/plugin-external-html@1.0.0"></script>
 <script src="https://unpkg.com/@jspsych/plugin-survey-text@1.1.3"></script>

</head>
<body></body>

<script>



var jsPsych = initJsPsych({
  on_finish: function() {
    var data = jsPsych.data.get();
    jatos.endStudy(data.json());
  }
  
});





var timeline = [];

  // generate a random subject ID that contains 8 alphanumeric characters
var rand_subject_id = jsPsych.randomization.randomID(8);
// add the ID to the data for all trials
jsPsych.data.addProperties({ ID: rand_subject_id });


// Define targetSentences and fillerSentences variables
var targetSentences = {
  timeline_variables: [
{ word: 'arbre', condition: 'Haute', item: '1', correct_response: 'K', type:"cibles"},
{ word: 'boîte', condition: 'Haute', item: '2', correct_response: 'K', type:"cibles"},
{ word: 'carte', condition: 'Haute', item: '3', correct_response: 'K', type:"cibles"},
{ word: 'chef', condition: 'Haute', item: '4', correct_response: 'K', type:"cibles"},
{ word: 'chien', condition: 'Haute', item: '5', correct_response: 'K', type:"cibles"},
{ word: 'choix', condition: 'Haute', item: '6', correct_response: 'K', type:"cibles"},
{ word: 'ciel', condition: 'Haute', item: '7', correct_response: 'K', type:"cibles"},
{ word: 'fête', condition: 'Haute', item: '8', correct_response: 'K', type:"cibles"},
{ word: 'goût', condition: 'Haute', item: '9', correct_response: 'K', type:"cibles"},
{ word: 'livre', condition: 'Haute', item: '10', correct_response: 'K', type:"cibles"},
{ word: 'lune', condition: 'Haute', item: '11', correct_response: 'K', type:"cibles"},
{ word: 'paix', condition: 'Haute', item: '12', correct_response: 'K', type:"cibles"},
{ word: 'pièce', condition: 'Haute', item: '13', correct_response: 'K', type:"cibles"},
{ word: 'pied', condition: 'Haute', item: '14', correct_response: 'K', type:"cibles"},
{ word: 'pluie', condition: 'Haute', item: '15', correct_response: 'K', type:"cibles"},
{ word: 'pont', condition: 'Haute', item: '16', correct_response: 'K', type:"cibles"},
{ word: 'rêve', condition: 'Haute', item: '17', correct_response: 'K', type:"cibles"},
{ word: 'robe', condition: 'Haute', item: '18', correct_response: 'K', type:"cibles"},
{ word: 'route', condition: 'Haute', item: '19', correct_response: 'K', type:"cibles"},
{ word: 'sœur', condition: 'Haute', item: '20', correct_response: 'K', type:"cibles"},
{ word: 'table', condition: 'Haute', item: '21', correct_response: 'K', type:"cibles"},
{ word: 'train', condition: 'Haute', item: '22', correct_response: 'K', type:"cibles"},
{ word: 'vent', condition: 'Haute', item: '23', correct_response: 'K', type:"cibles"},
{ word: 'ville', condition: 'Haute', item: '24', correct_response: 'K', type:"cibles"},
{ word: 'aigle', condition: 'Basse', item: '25', correct_response: 'K', type:"cibles"},
{ word: 'berge', condition: 'Basse', item: '26', correct_response: 'K', type:"cibles"},
{ word: 'bille', condition: 'Basse', item: '27', correct_response: 'K', type:"cibles"},
{ word: 'bûche', condition: 'Basse', item: '28', correct_response: 'K', type:"cibles"},
{ word: 'bulle', condition: 'Basse', item: '29', correct_response: 'K', type:"cibles"},
{ word: 'cidre', condition: 'Basse', item: '30', correct_response: 'K', type:"cibles"},
{ word: 'crabe', condition: 'Basse', item: '31', correct_response: 'K', type:"cibles"},
{ word: 'crêpe', condition: 'Basse', item: '32', correct_response: 'K', type:"cibles"},
{ word: 'cube', condition: 'Basse', item: '33', correct_response: 'K', type:"cibles"},
{ word: 'cycle', condition: 'Basse', item: '34', correct_response: 'K', type:"cibles"},
{ word: 'fable', condition: 'Basse', item: '35', correct_response: 'K', type:"cibles"},
{ word: 'flûte', condition: 'Basse', item: '36', correct_response: 'K', type:"cibles"},
{ word: 'frein', condition: 'Basse', item: '37', correct_response: 'K', type:"cibles"},
{ word: 'gant', condition: 'Basse', item: '38', correct_response: 'K', type:"cibles"},
{ word: 'grue', condition: 'Basse', item: '39', correct_response: 'K', type:"cibles"},
{ word: 'myope', condition: 'Basse', item: '40', correct_response: 'K', type:"cibles"},
{ word: 'niche', condition: 'Basse', item: '41', correct_response: 'K', type:"cibles"},
{ word: 'ogre', condition: 'Basse', item: '42', correct_response: 'K', type:"cibles"},
{ word: 'perle', condition: 'Basse', item: '43', correct_response: 'K', type:"cibles"},
{ word: 'pneu', condition: 'Basse', item: '44', correct_response: 'K', type:"cibles"},
{ word: 'pôle', condition: 'Basse', item: '45', correct_response: 'K', type:"cibles"},
{ word: 'rame', condition: 'Basse', item: '46', correct_response: 'K', type:"cibles"},
{ word: 'ride', condition: 'Basse', item: '47', correct_response: 'K', type:"cibles"},
{ word: 'veuf', condition: 'Basse', item: '48', correct_response: 'K', type:"cibles"},
   
  ],
};

var fillerSentences = {
  timeline_variables: [
{ word: 'aucle', condition: 'fillers', item: '1', correct_response: 'D', type:"fillers"},
{ word: 'merve', condition: 'fillers', item: '2', correct_response: 'D', type:"fillers"},
{ word: 'sulle', condition: 'fillers', item: '3', correct_response: 'D', type:"fillers"},
{ word: 'fûgne', condition: 'fillers', item: '4', correct_response: 'D', type:"fillers"},
{ word: 'rille', condition: 'fillers', item: '5', correct_response: 'D', type:"fillers"},
{ word: 'pivre', condition: 'fillers', item: '6', correct_response: 'D', type:"fillers"},
{ word: 'flace', condition: 'fillers', item: '7', correct_response: 'D', type:"fillers"},
{ word: 'grêde', condition: 'fillers', item: '8', correct_response: 'D', type:"fillers"},
{ word: 'puje', condition: 'fillers', item: '9', correct_response: 'D', type:"fillers"},
{ word: 'pycre', condition: 'fillers', item: '10', correct_response: 'D', type:"fillers"},
{ word: 'tadre', condition: 'fillers', item: '11', correct_response: 'D', type:"fillers"},
{ word: 'brûre', condition: 'fillers', item: '12', correct_response: 'D', type:"fillers"},
{ word: 'froin', condition: 'fillers', item: '13', correct_response: 'D', type:"fillers"},
{ word: 'galt', condition: 'fillers', item: '14', correct_response: 'D', type:"fillers"},
{ word: 'grou', condition: 'fillers', item: '15', correct_response: 'D', type:"fillers"},
{ word: 'myage', condition: 'fillers', item: '16', correct_response: 'D', type:"fillers"},
{ word: 'voche', condition: 'fillers', item: '17', correct_response: 'D', type:"fillers"},
{ word: 'ébre', condition: 'fillers', item: '18', correct_response: 'D', type:"fillers"},
{ word: 'parne', condition: 'fillers', item: '19', correct_response: 'D', type:"fillers"},
{ word: 'freu', condition: 'fillers', item: '20', correct_response: 'D', type:"fillers"},
{ word: 'rèle', condition: 'fillers', item: '21', correct_response: 'D', type:"fillers"},
{ word: 'bage', condition: 'fillers', item: '22', correct_response: 'D', type:"fillers"},
{ word: 'bime', condition: 'fillers', item: '23', correct_response: 'D', type:"fillers"},
{ word: 'vauf', condition: 'fillers', item: '24', correct_response: 'D', type:"fillers"},

  ],
};

var practicesentences = {
  timeline_variables: [
  { word: 'vélo', condition: 'MOT', item: '1', correct_response: 'K', type:"practice"},
{ word: 'roup', condition: 'PSEUDOMOT', item: '2', correct_response: 'D', type:"practice"},
{ word: 'sopu', condition: 'MOT', item: '3', correct_response: 'K', type:"practice"},
{ word: 'clé', condition: 'PSEUDOMOT', item: '4', correct_response: 'D', type:"practice"},

     ],
};




// Combine targetSentences and fillerSentences into a single array

var allSentences = targetSentences.timeline_variables.concat(fillerSentences.timeline_variables);

// Fisher-Yates (Knuth) shuffle algorithm
function shuffleArray(array) {
  for (let i = array.length - 1; i > 0; i--) {
    let j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
};


// Shuffle the allSentences array
shuffleArray(allSentences);




var practicesentencesarray = practicesentences.timeline_variables;

// Shuffle the fillers array
shuffleArray(practicesentencesarray);




var check_consent = function(elem) {
    if (document.getElementById('consent_checkbox2').checked) {
        return true;
    }
    else {
        alert("Si vous souhaitez participer, vous devez cocher la case \u00e0 c\u00f4t\u00e9 de la d\u00e9claration `J\'ai bien compris le consigne.`");
        return false;
    }
    return false;
};

// Instructions
var instructions = {
  type: jsPsychExternalHtml,
    url: "https://raw.githubusercontent.com/cpozniak/psycholing/main/consignesTDL.html",
    cont_btn: "start2",
    check_fn: check_consent
};



// Fin
var fin = {
  type: jsPsychHtmlKeyboardResponse,
  stimulus: 'Fin de l\'exp&eacute;rience, appuyez sur la touche Entr&eacute;e pour sauvegarder vos données, merci beaucoup pour votre participation !'
  };



// avantpractice
var sep1 = {
 type: jsPsychHtmlButtonResponse,
 stimulus: `Commen&ccedil;ons par un petit entra&icirc;nement.`,
 choices: [`On commence`]
};


var sep3 = {
  type: jsPsychHtmlButtonResponse,
  stimulus: `L\'exp&eacute;rience est presque finie, il vous reste seulement quelques questions.`,
  choices: [`On continue`]
};


// Commencement
var sep2 = {
 type: jsPsychHtmlButtonResponse,
 stimulus: `L\'entra&icirc;nement est termin&eacute;. On peut commencer !`,
 choices: [`C\'est parti`]
};





// practice


var practice = {
  timeline: [],
};

practicesentencesarray.forEach((sentence) => {
  practice.timeline.push({
    type: jsPsychHtmlKeyboardResponse,
    stimulus: '<p style="font-family: Arial; font-size: 25pt;">+</p>',
    trial_duration: 500,
  });

 
  practice.timeline.push({
    type: jsPsychHtmlKeyboardResponse,
    stimulus:  `<p style="font-family: Arial; font-size: 25pt;">${sentence.word}</p><p>D si ce n'est pas un mot et K si c'est un mot</p>`,
    choices: ['D', 'K'],
    data: {
      task: 'response',
      item: sentence.item,
      correct_response: sentence.correct_response,
      condition: sentence.condition,
      word: sentence.word,
      type:sentence.type,
    },
    on_finish: function (data) {
      data.correct = jsPsych.pluginAPI.compareKeys(data.response, data.correct_response);
      data.choice = data.response;
    },
    trial_duration: 3000,
    response_ends_trial: true,
  });

});



var experiment = {
  timeline: [],
};

allSentences.forEach((sentence) => {
    experiment.timeline.push({
    type: jsPsychHtmlKeyboardResponse,
    stimulus: '<p style="font-family: Arial; font-size: 25pt;">+</p>',
    trial_duration: 500,
  });

 
  experiment.timeline.push({
    type: jsPsychHtmlKeyboardResponse,
    stimulus:  `<p style="font-family: Arial; font-size: 25pt;">${sentence.word}</p>`,
    choices: ['D', 'K'],
    data: {
      task: 'response',
      item: sentence.item,
      correct_response: sentence.correct_response,
      condition: sentence.condition,
      word: sentence.word,
      type:sentence.type,
    },
    on_finish: function (data) {
      data.correct = jsPsych.pluginAPI.compareKeys(data.response, data.correct_response);
      data.choice = data.response;
    },
    trial_duration: 3000,
    response_ends_trial: true,
  });

});




// Timeline
var test_procedure = {
    timeline: [instructions, sep1, practice, sep2, experiment, fin],
};
timeline.push(test_procedure);

jatos.onLoad(() => {
  jsPsych.run(timeline);
}); 

</script>


</html>